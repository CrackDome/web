<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/nt/pktmon.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:04:49 GMT -->

<head><meta charset="UTF-8">
<meta name="viewport" content="width=768, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>PktMon - Monitor internal packet propagation - Windows CMD - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_nt.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html">SS64</a></li>
<li class="tbtn"><a href="index.html">CMD <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li class="tbtn"><a href="syntax.html">How-to <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/nt/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>PktMon.exe</h1>
<p>Monitor internal packet propagation and packet drop reports. Run all PktMon commands from an <a href="syntax-elevate.html">Elevated</a> command prompt.</p>
<pre>Syntax - List all active components:
      <b>PKTMON comp</b> list <i>options
</i>
   Options:
   -i, --show-hidden
   Show components that are hidden by default.

   --json  Output the list in Json format

Syntax - Display current per-component counters:
      <b>PKTMON comp</b> counters <i>options</i>

   Options:
   -i, --show-hidden
   Show components that are hidden by default.

   --json  Output the list in Json format

   -t,--counter-type
   Select which types of counters to show
   Supported values are all counters (default), drops only, or flows only.

   -z, --show-zeros
   Show counters that are zero in both directions.

Syntax - Manage packet filters:
      <b>PKTMON filter</b> { list | add | remove } [<i>options</i> | help]

   Key:
      list    Display active packet filters.
      add     Add a filter to control which packets are reported.
      remove  Removes all filters.
      help    Show help text and sub-options for a command.

Syntax - Reset all component counters to zero:
      <b>PKTMON reset</b>[-counters]

Syntax - Stop packet monitoring and show results:
      <b>PKTMON stop</b>

Syntax - Convert log file to text format:
      <b>PKTMON format</b> log.etl [-o log.txt]
   Key:
   -o, --out     Name of the formatted text file.

Syntax - Stop the PktMon driver service and unload PktMon.sys:
      <b>PKTMON unload</b>
      Effectively equivalent to '<a href="sc.html">SC.exe</a> stop PktMon'.
      Measurement (if active) will immediately stop, and any state will be
      deleted (counters, filters, etc.).

Syntax - Start packet monitoring:
      <b>PKTMON start</b> [-c { <u>all</u> | nics | [ids...] }] [-d]
         [--etw [-p <i>size</i>] [-k <i>keywords</i>]]  [-f] [-s] [-r] [-m]

   Key:
   -c, --components
      Select components to monitor. Can be <u>all</u> components, NICs only, or a
      list of component ids. Defaults to all.

  -d, --drop-only
      Only report dropped packets. By default, successful packet propagation
      is reported as well.

   ETW Logging
      --etw
         Start a logging session for packet capture.

      -p, --packet-size
         Number of bytes to log from each packet. To always log the entire
         packet, set this to 0. Default is 128 bytes.

      -k, --keywords
         Hexadecimal bitmask (i.e. sum of the below flags) that controls
         which events are logged. By default all events are logged.

         Flags:
         0x001 - General configuration events.
         0x002 - Component related information, including counters.
         0x004 - Pre-parsed packets.
         0x008 - Packet metadata (NBL OOB).
         0x010 - Raw packet payload.

   -f, --file-name
      .etl log file. Default is PktMon.etl.

   -s, --file-size
      Maximum log file size in megabytes. Default is 512 MB.

   Logging mode

      -r, --circular
         New events overwrite the oldest ones when 
         when the maximum file size is reached.

      -m, --multi-file
         A new log file is created when the maximum file size is reached.
         Log files are sequentially numbered. PktMon1.etl, PktMon2.etl, etc.</pre>
<p> <b>Examples</b></p>
<p>Create a packet filter for the traffic on TCP port 20:<br>
<br>
<span class="code">pktmon filter add -p 20</span></p>
<p>List the current packet filters:</p>
<p class="code">pktmon filter list </p>
<p>Start monitoring to a file called PktMon.etl (n.b. without the -p option this will default to capturing only the first 128 bytes of each packet.):</p>
<p class="code">pktmon start --etw</p>
<p>Stop monitoring:</p>
<p><span class="code">pktmon stop</span></p>
<p>Convert the  PktMon.etl file to a human-readable text format:</p>
<p><span class="code">pktmon format PktMon.etl -o converted.txt</span><br>
</p>
<p><i><span class="quote">â€œSooner or later we all discover that the important moments in life are not the advertised ones, not the birthdays, the graduations, the weddings, not the great goals achieved. The real milestones are less prepossessing. They come to the door of memory unannounced, stray dogs that amble in, sniff around a bit and simply never leave. Our lives are measured by these&rdquo; ~ Susan B. Anthony</span></i></p>
<p><b>Related:</b><br>
<br>
<span class="space"> <a href="https://www.microsoft.com/en-in/download/details.aspx?id=4865">Microsoft Network Monitor</a> - View the .ETL file generated by PktMon.<br>
<a href="https://www.bleepingcomputer.com/news/microsoft/windows-10-quietly-got-a-built-in-network-sniffer-how-to-use/">How to use PktMon</a> - Bleeping Computer.<br>
Equivalent macOS command : <a href="../osx/tcpdump.html">tcpdump</a> - Dump traffic on a network.</span></p><!-- #BeginLibraryItem "/Library/foot_nt.lbi" --><p>
<script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- windows300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="7649547908"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<hr>
<div id=bl>&nbsp;</div>
<div id=br>Copyright &copy; 1999-2020 <a href="../index.html">SS64.com</a><br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/nt/pktmon.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:04:49 GMT -->
</html>
