<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/nt/syntax-getdate.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:08:47 GMT -->

<head><meta charset="UTF-8">
<meta name="viewport" content="width=768, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>GetDate - Windows CMD - SS64.com</title>
</head>
<body><!-- #BeginLibraryItem "/Library/head_ntsyntax.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html">SS64</a></li>
<li class="tbtn"><a href="index.html">CMD <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li class="tbtn"><a href="syntax.html">How-to <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/nt/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>How-to: Get the current Date - GetDate.cmd</h1>
<p>Display the date and time independent of OS Locale, Language or the users chosen date format (Control Panel/Regional).</p>
<p>If all you need is the current date and time in <b>local</b> format, you can just use the built in variables <span class="code">%date% </span>and <span class="code">%time%</span> the more difficult problem is  making this work for <i>any</i> locale so that it can be used across international networks.</p>
<p>Method 1 - Calling a VBScript <a href="../vb/syntax-getdate.html">getdate.vbs</a></p>
<pre>@Echo off
For /f %%G in ('cscript /nologo <b>getdate.vbs</b>') do set _dtm=%%G
Set _yyyy=%_dtm:~0,4%
Set _mm=%_dtm:~4,2%
Set _dd=%_dtm:~6,2%
Set _hh=%_dtm:~8,2%
Set _nn=%_dtm:~10,2%
Echo %_yyyy%-%_mm%-%_dd%T%_hh%:%_nn%</pre>
<p>Method 2 - Calling <a href="wmic.html">WMIC</a></p> 
<pre>@Echo off
:: Check WMIC is available
WMIC.EXE Alias /? >NUL 2>&1 || GOTO s_error

:: Use WMIC to retrieve date and time
FOR /F "skip=1 tokens=1-6" %%G IN ('<b>WMIC</b> Path Win32_LocalTime Get Day^,Hour^,Minute^,Month^,Second^,Year /Format:table') DO (
   IF "%%~L"=="" goto s_done
      Set _yyyy=%%L
      Set _mm=00%%J
      Set _dd=00%%G
      Set _hour=00%%H
      SET _minute=00%%I
)
:s_done

:: Pad digits with leading zeros
      Set _mm=%_mm:~-2%
      Set _dd=%_dd:~-2%
      Set _hour=%_hour:~-2%
      Set _minute=%_minute:~-2%

:: Display the date/time in ISO 8601 format:
Set _isodate=%_yyyy%-%_mm%-%_dd% %_hour%:%_minute%
Echo %_isodate%

GOTO:EOF

:s_error
Echo GetDate.cmd
Echo Displays date and time independent of OS Locale, Language or date format.
Echo:
Echo Returns 6 environment variables containing isodate,Year,Month,Day,hour and minute.
Based on the <a href="https://www.robvanderwoude.com/files/sortdate5_xp.txt">sorted date</a> code by Rob van der Woude.</pre>
<p>This works under Windows 7/Windows 10 independent of the short date format / Operating System Language/ Locale.
<p class="quote"><i>&quot;I've been on the calendar, but never on time&quot; ~ Marilyn Monroe </i></p>
<p><b>Related</b>
<p class="space"><a href="../vb/syntax-getdatetime.html">datetime.vbs</a> - Get Date, Time and daylight savings (VB Script)<br>
<a href="../links/doff10.zip">DOFF.exe</a> - Print a formatted date and time, with an optional date offset, e.g. -1 prints yesterday, +1 prints tomorrow. 
(<a href="../links/doff10_source.zip">source</a> + BSD licence).<br>
<a href="https://stackoverflow.com/questions/11124572/what-is-the-windows-equivalent-of-the-command-dates/11128674#11128674">Get UNIX format date</a> - Dave Benham / StackOverflow (WMIC)<br>
<a href="../dates.html">Standard date and time notation</a> - ( <span class="code">YYYY-MM-DD</span> )<br>
<a href="https://www.robvanderwoude.com/datetiment.html">Date/Time scripts</a> - Rob van der Woude.<br>
<a href="https://ritchielawrence.github.io/batchfunctionlibrary/#date-and-time-functions">Date/Time scripts</a> - Ritchie Lawrence.
<!-- #BeginLibraryItem "/Library/foot_nt.lbi" --><p>
<script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- windows300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="7649547908"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<hr>
<div id=bl>&nbsp;</div>
<div id=br>Copyright &copy; 1999-2020 <a href="../index.html">SS64.com</a><br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/nt/syntax-getdate.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:08:47 GMT -->
</html>