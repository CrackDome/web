<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/ps/invoke-cimmethod.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:05:46 GMT -->

<head><meta charset="UTF-8">
<meta name="viewport" content="width=768, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>Invoke-CimMethod - PowerShell - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html">SS64</a></li>
<li class="tbtn"><a href="index.html">PowerShell <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li class="tbtn"><a href="syntax.html">How-to <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>Invoke-CimMethod (PowerShell 3.0+ )</h1> 
<p>Invoke a method of a CIM class or CIM instance. Equivalent to the old WMI cmdlet <a href="invoke-wmimethod.html">Invoke-WmiMethod</a> , the CIM version uses WSMAN (WinRM) to connect to remote machines and is therefore an order of magnitude faster.</p>
<pre>Syntax
      Invoke-CimMethod [<b>-ClassName</b>] <i>String</i> [[-Arguments] <i>IDictionary</i>] [-MethodName] <i>String
   </i>      <b>[</b> [-ComputerName <i>String</i>[]] <b>|</b> -CimSession <i>CimSession</i>[] <b>]</b>
            [-Namespace <i>String</i>]
               [-OperationTimeoutSec <i>UInt32</i>] [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]

      Invoke-CimMethod [<b>-CimClass</b>] <i>CimClass</i> [[-Arguments] <i>IDictionary</i>] [-MethodName] <i>String</i>
         <b>[</b> [-ComputerName <i>String</i>[]] <b>|</b> -CimSession <i>CimSession</i>[] <b>]</b>
            [-OperationTimeoutSec <i>UInt32</i>] [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]

      Invoke-CimMethod [-InputObject] <i><b>CimInstance</b></i> [[-Arguments] <i>IDictionary</i>] [-MethodName] <i>String</i>
         <b>[</b> [-ComputerName <i>String</i>[]] <b>|</b> -CimSession <i>CimSession</i>[] <b>]</b>
            [-ResourceUri <i>Uri</i>]
               [-OperationTimeoutSec <i>UInt32</i>]  [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]

      Invoke-CimMethod [[-Arguments] <i>IDictionary</i>] [-MethodName] <i>String</i> [-Namespace <i>String</i>]
         <b>[</b> [-ComputerName <i>String</i>[]] <b>|</b> -CimSession <i>CimSession</i>[] <b>]</b>
            <b>-ResourceUri</b> <i>Uri</i>
               [-OperationTimeoutSec <i>UInt32</i>] [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]

      Invoke-CimMethod [[-Arguments] <i>IDictionary</i>] [-MethodName] <i>String</i> [-Namespace <i>String</i>]
         <b>[</b> [-ComputerName <i>String</i>[]] <b>|</b> -CimSession <i>CimSession</i>[] <b>]</b>
            [-QueryDialect <i>String</i>] <b>-Query</b> <i>String
 </i>              [-OperationTimeoutSec <i>UInt32</i>] [-Confirm] [-WhatIf]  [<i><a href="common.html">CommonParameters</a></i>]

Key
   -Arguments <i>IDictionary</i>
       Specifies the parameters to pass to the called method.
       Specify the values for this parameter as name-value pairs, stored in a hash table.
       The order of the values entered is not important.

   -CimClass <i>CimClass</i>
       Specifies a CIM class object that represents a CIM class definition on the server.
       Use this parameter when invoking a static method of a class.
       You can use the Get-CimClass cmdlet to retrieve a class definition from the server.
       Using this parameter results in better client side schema validations.

   -CimSession <i>CimSession</i>[]
       Run the command using the specified CIM session. Enter a variable that contains the CIM session, or a command
       that creates or gets the CIM session, such as the New-CimSession or Get-CimSession cmdlets. For more 
       information, see about_CimSessions.
        
   -ClassName <i>String</i>
       The name of the CIM class for which to perform the operation. This parameter is only used for static methods. 
       NOTE: You can use tab completion to browse the list of classes, because wps_2 gets a list of classes from the 
       local WMI server to provide a list of class names.
        
   -ComputerName <i>String</i>[]
       The computer on which you want to run the CIM operation. You can specify a fully qualified domain name 
       (FQDN), a NetBIOS name, or an IP address.
        
       If you specify this parameter, the cmdlet creates a temporary session to the specified computer using the 
       WsMan protocol.If you do not specify this parameter, the cmdlet performs the operation on the local computer
       using Component Object Model (COM).

       If multiple operations are being performed on the same computer, using a CIM session gives better performance.
        
   -InputObject <i>CimInstance</i>
       A CIM instance object to use as input to invoke a method.
       This parameter can only be used to invoke instance methods.
       To invoke class static methods, use the -Class parameter or the -CimClass parameter.

   -MethodName <i>String</i>
       The name of the CIM <i>method</i> to invoke. This parameter is mandatory and cannot be null or empty.
       To invoke static method of a CIM class use the ClassName or the CimClass parameter.

   -Namespace <i>String</i>
       Specifies the namespace for CIM operation. The default namespace is root/cimv2.
       NOTE: You can use tab completion to browse the list of namespaces, because wps_2 gets a list of namespaces
       from the local WMI server to provide the list of namespaces.
 
   -OperationTimeoutSec <i>UInt32</i>
       Specifies the amount of time that the cmdlet waits for a response from the computer.
        
       By default, the value of this parameter is 0, which means that the cmdlet uses the default timeout value for 
       the server.
        
       If the OperationTimeoutSec parameter is set to a value less than the robust connection retry timeout of 3 
       minutes, network failures that last more than the value of the OperationTimeoutSec parameter are not 
       recoverable, because the operation on the server times out before the client can reconnect.
       
   -Query <i>String</i>
       Specifies a query to run on the CIM server.
       A method is invoked on the instances received as a result of the query.

       You can specify the query dialect using the -QueryDialect parameter.

       If the value specified contains double quotes (“), single quotes (‘), or a backslash (\), you must escape
       those characters by prefixing them with the backslash (\) character.

       If the value specified uses the WQL LIKE operator, then you must escape the following characters by
       enclosing them in square brackets ([]): percent(%), underscore (_), or opening square bracket ([).

   -QueryDialect <i>String</i>
       Specifies the query language used for the Query parameter. psdx_paramvalues WQL or CQL.
       The default value is WQL.

   -ResourceUri <i>Uri
 </i>      Specifies the resource uniform resource identifier (URI) of the resource class or instance.
       The URI is used to identify a specific type of resource, such as disks or processes, on a computer.
       A URI consists of a prefix and a path to a resource.
       For example:
             HYPERLINK &quot;http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/Win32_LogicalDisk&quot;
                 http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/Win32_LogicalDisk
             HYPERLINK &quot;http://intel.com/wbem/wscim/1/amt-schema/1/AMT_GeneralSettings&quot;
                 http://intel.com/wbem/wscim/1/amt-schema/1/AMT_GeneralSettings

       By default, if you do not specify this parameter, the DMTF standard resource URI
          http://schemas.dmtf.org/wbem/wscim/1/cim-schema/2/
       is used and the class name is appended to it.

       ResourceURI can only be used with CIM sessions created using the WSMan protocol, or when specifying
       the -ComputerName parameter, which creates a CIM session using WSMan.
       If you specify this parameter without specifying the -ComputerName parameter, or if you specify
       a CIM session created using DCOM protocol, you will get an error, because the DCOM protocol
       does not support the -ResourceURI parameter.

       If both -ResourceUri and -Filter are specified, the -Filter parameter is ignored.

   -confirm
       Prompt for confirmation before executing the command.

   -whatIf
       Describe the command without actually executing it.</pre>
<p>Standard <a href="get-alias.html">Alias</a> for Invoke-CimMethod:<span class="code"> <b>icim</b></span></p>
<p><b>Examples</b></p>
<p>Reboot three machines at once:</p>
<pre><span class="code">PS C:\&gt; Invoke-CimMethod –ClassName Win32_OperatingSystem –MethodName <b>Reboot</b> –ComputerName 'Server64','Server65','Server66</span>'</pre>
<p>Invoke the method named Terminate on the CIM class named Win32_Process:</p>
<p><span class="code">PS C:\&gt; </span><span class="code">Invoke-CimMethod –Query ꞌselect * from Win32_Process where name like &quot;notepad%&quot;ꞌ –MethodName &quot;Terminate&quot;</span></p>
<p>Invoke the <span class="code">GetOwner</span> method using CIM instance object:<br>
<span class="code">PS C:\&gt; $npproc = Get-CimInstance -Query ꞌSelect * from Win32_Process where name like &quot;notepad%&quot;ꞌ</span><br>
<span class="code">PS C:\&gt; Invoke-CimMethod -InputObject $npproc -MethodName GetOwner</span><br>
</p>
<p>Invoke a static method to create a new Process:</p>
<p><span class="code">PS&gt; Invoke-CimMethod –ClassName Win32_Process –MethodName &quot;Create&quot; –Arguments @{ Path = &quot;notepad.exe&quot; }</span></p>
<p>Invoke a method using arguments:</p>
<p class="code">PS C:\&gt; Invoke-CimMethod -ClassName Win32_Process -MethodName &quot;Create&quot; -Arguments @{ CommandLine = ꞌnotepad.exeꞌ;      CurrentDirectory = &quot;C:\windows\system32&quot; }</p>
<p>Client-side validation for the method named xyz:</p>
<p><span class="code">PS C:\&gt; $ccl = Get-CimClass –ClassName Win32_Process<br>
PS C:\&gt; Invoke-CimMethod -CimClass $ccl -MethodName "xyz" –Arguments @{ CommandLine = 'notepad.exe'}<br>
</span> <span class="code">Invoke-CimMethod : Can not find method 'xyz' in class 'Win32_Process'</span>.<br>
</p>

<i class="quote">“Interactive users are twice as productive when the computer response time is 0.25 second instead of 2.0 Seconds” ~   <a href="https://ieeexplore.ieee.org/document/5387803">Doherty and Kelisky IBM Computer systems Journal, 1984</a></i>
<p><b>Related PowerShell Cmdlets:</b></p>
<p class="space"><a href="get-cimassociatedinstance.html">Get-CimAssociatedInstance</a> - Retrieve CIM instance by an association.<br>
<a href="get-ciminstance.html">Get-CimInstance</a> -  Get a managed resource (storage, network, software etc).<br>
<a href="new-ciminstance.html">New-CimInstance</a> - Create a new instance of a class.</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- PowerShell300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6253539900"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<hr>
<div id=bl>&nbsp;</div>
<div id=br>Copyright &copy; 1999-2020 <a href="../index.html">SS64.com</a><br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/ps/invoke-cimmethod.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:05:46 GMT -->
</html>
