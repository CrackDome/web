<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/ps/messagebox.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:06:04 GMT -->

<head><meta charset="UTF-8">
<meta name="viewport" content="width=768, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<link rel="STYLESHEET" href="../tables.css" type="text/css">
<title>MessageBox - PowerShell - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html">SS64</a></li>
<li class="tbtn"><a href="index.html">PowerShell <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li class="tbtn"><a href="syntax.html">How-to <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>MessageBox (.Net Method)</h1> 
<p>Display a message box to the user, optionally with a choice of: OK/Cancel/Yes/No.</p>
<pre>Syntax
      <a href="add-type.html">Add-Type</a> -AssemblyName PresentationCore,PresentationFramework
      $Result = [System.Windows.MessageBox]<b>::Show(</b><i>MessageBody</i>,<i>Title</i>,<i>ButtonType</i>,<i>Image</i><b>)</b>
 
Key
   <i>MessageBody</i> 
       A string containing the message text.

   <i>Title</i>
       A string containing the title bar text for the message box.

   <i>ButtonType</i>
      An integer containing the type of button to display:

   <i>Image</i>
      An integer representing the icon to display (if any).</pre>
<blockquote>
<table width="25%">
<tr>
<th scope="col">Image</th>
<th scope="col">Value</th>
<td scope="col">&nbsp;</td>
<th scope="col">ButtonType</th>
<th scope="col">Value</th>
</tr>
<tr>
<td><b><u>None</u></b></td>
<td>0</td>
<td>&nbsp;</td>
<td><u>OK</u></td>
<td>0</td>
</tr>
<tr>
<td><b>Hand&nbsp;</b>/&nbsp;Error&nbsp;/&nbsp;Stop</td>
<td>16</td>
<td>&nbsp;</td>
<td>OKCancel</td>
<td>1</td>
</tr>
<tr>
<td><b>Question</b></td>
<td>32</td>
<td>&nbsp;</td>
<td>YesNoCancel</td>
<td>3</td>
</tr>
<tr>
<td><b>Warning</b>&nbsp;/&nbsp;Exclamation</td>
<td>48</td>
<td>&nbsp;</td>
<td>YesNo</td>
<td>4</td>
</tr>
<tr>
<td><b>Asterisk</b>&nbsp;/&nbsp;Information</td>
<td>64</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</table>
<p>
  The <i>Button type </i>and <i>Image </i>can be supplied as either a number, the equivalent  text string or with a full reference like: <span class="code">[System.Windows.MessageBoxButton]::YesNoCancel</span></p>
<p>Sample image icons can be viewed on the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.messageboximage?redirectedfrom=MSDN&amp;view=netframework-4.8">MessageBoxImage Enum</a> - docs.microsoft.com</p>
<p>The MessageBox will return one of these  values:</p>
<table width="25%" border="1">
<tr>
<th scope="col">Result</th>
<th scope="col">Value</th>
</tr>
<tr>
<td>None&nbsp;(no&nbsp;result)</td>
<td>0</td>
</tr>
<tr>
<td>OK</td>
<td>1</td>
</tr>
<tr>
<td>Cancel</td>
<td>2</td>
</tr>
<tr>
<td>Yes</td>
<td>6</td>
</tr>
<tr>
<td>No.</td>
<td>7</td>
</tr>
</table>
</blockquote>
<p>All the values given above can  be enumerated using <span class="code">getNames()</span></p>
<p class="code">[enum]::getNames([System.Windows.MessageBoxButton])<br>
[enum]::getNames([System.Windows.MessageBoxImage])</p>
<p><b>Examples</b></p>
<p>Display a simple message to the user:</p>
<p><span class="code">Add-Type -AssemblyName PresentationCore,PresentationFramework</span><br>
<span class="code">$msgBody = "This is a simple message with just the default OK button"</span><br>
<span class="code">[System.Windows.MessageBox]::Show($msgBody)</span></p>
<p>Ask the user a question and save the answer (Yes, No or Cancel) in the variable <span class="code">$Result</span>:</p>
<p><span class="code">Add-Type -AssemblyName PresentationCore,PresentationFramework</span><br>
<span class="code"><br>
$msgBody = "Reboot the computer now?"<br>
$msgTitle = "Confirm Reboot"</span><br>
<span class="code">$msgButton = 'YesNoCancel'<br>
</span><span class="code">
$msgImage = 'Question</span>'<br>
<span class="code">$Result = [System.Windows.MessageBox]::Show($msgBody,$msgTitle,$msgButton,$msgImage)<br>
Write-Host &quot;The user chose: $Result [&quot; ($result).value__ &quot;]&quot;</span><br>
</p>
<p class="quote"><i>&ldquo;To Thales the primary question was not what do we know, but how do we know it&rdquo; ~ Aristotle</i></p><p><b>Related PowerShell Cmdlets:</b></p>
<p class="space">  <span class="body"><a href="read-host.html">Read-Host</a> - Read a line of input from the host console.<br>
<a href="write-host.html">Write-Host</a> - Display objects through the host user interface.</span><br>
<a href="https://www.codeproject.com/Articles/18399/Localizing-System-MessageBox">Localizing System MessageBox</a> - Multi language Message Box.<br>
An alternative but similar MessageBox method is available via Windows Forms, loading <span class="code">[System.Windows<b>.Forms</b>.MessageBox]<br>
</span> Equivalent CMD script: <span class="code"><a href="../nt/choice.html">CHOICE</a></span><br>
Equivalent VBScript: <a href="../vb/msgbox.html" class="code">MSGBOX</a><br>  
Equivalent bash command (Linux): <a href="../bash/case.html">case</a> / <a href="../bash/select.html">select</a> - Accept keyboard input.</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- PowerShell300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6253539900"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<hr>
<div id=bl>&nbsp;</div>
<div id=br>Copyright &copy; 1999-2020 <a href="../index.html">SS64.com</a><br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/ps/messagebox.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:06:04 GMT -->
</html>