<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/ps/new-cimsession.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:05:47 GMT -->

<head><meta charset="UTF-8">
<meta name="viewport" content="width=768, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>New-CIMSession - PowerShell - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html">SS64</a></li>
<li class="tbtn"><a href="index.html">PowerShell <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li class="tbtn"><a href="syntax.html">How-to <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>New-CIMSession (PowerShell 3.0+ )</h1> 
<p>Create a CIM session. A CIM session is a client-side object representing a connection      to a local or remote computer.</p>
<p>When performing a large number of remote operations against the same remote machine, create and reuse a CIM session rather than  connecting repeatedly with <a href="get-ciminstance.html"><span class="code">Get-CimInstance</span></a>. This can provide a significant performance gain.</p>
<pre>Syntax
      New-CimSession [[-ComputerName] <i>String[]</i>] [[<b>-Credential</b>] <i>PSCredential</i>] [-Name <i>String</i>]
         [-Port <i>UInt32</i>] [-SessionOption <i>CimSessionOptions</i>] [-Authentication <i>PasswordAuthenticationMechanism</i>]
            [-SkipTestConnection] [-OperationTimeoutSec <i>UInt32</i>] [<i><a href="common.html">CommonParameters</a></i>]


      New-CimSession [[-ComputerName] <i>String[]</i>] [<b>-CertificateThumbprint</b> <i>String</i>] [-Name <i>String</i>]                                        
         [-Port <i>UInt32</i>] [-SessionOption <i>CimSessionOptions</i>]
            [-SkipTestConnection] [-OperationTimeoutSec <i>UInt32</i>] [<i><a href="common.html">CommonParameters</a></i>]

Key
   -Authentication <i>PasswordAuthenticationMechanism</i>
       The authentication type used for the user's credentials. psdx_paramvaluesDefault, Digest, Negotiate, 
       Basic, Kerberos, NtlmDomain and CredSsp.

       You cannot use the NtlmDomain authentication type for connection to the local computer. CredSSP authentication 
       is available only in firstref_vista, firstref_longhorn, and later versions of Windows.

       Caution: Credential Security Service Provider (CredSSP) authentication, in which the user’s credentials are 
       passed to a remote computer to be authenticated, is designed for commands that require authentication on more 
       than one resource, such as accessing a remote network share. This mechanism increases the security risk of the 
       remote operation. If the remote computer is compromised, the credentials that are passed to it can be used to 
       control the network session.

   -CertificateThumbprint <i>String</i>
       The digital public key certificate (X.509) of a user account that has permission to perform this action.
       Enter the certificate thumbprint of the certificate.

       Certificates are used in client certificate-based authentication.
       They can be mapped only to local user accounts; they do not work with domain accounts.

       To get a certificate thumbprint, use the Get-Item or Get-ChildItem cmdlets in the wps_1 Certificate provider. 
       For more information about using the wps_2 Certificate provider, type Get-Help Certificate, or see <a href="https://blogs.technet.microsoft.com/heyscriptingguy/2013/12/04/getting-started-with-powershell-the-certificate-provider/">TechNet</a>.

   -ComputerName <i>String</i>[]
       The name of the computer to which to create the CIM session.
       Specify either a single computer name, or multiple computer names separated by a comma. 
          
       When -ComputerName is specified the WS-Management (WS-Man) protocol will be used.

       If ComputerName is not specified, a CIM session to the local computer is created.
       You can specify the value for computer name in one of the following formats: 
                    
         One or more NetBIOS names              
         One or more IP addresses 
         One or more fully qualified domain names.

       If the computer is in a different domain than the user, you must specify the fully qualified domain name.
       You can also pass a computer name (in quotes) to New-CimSession by using the pipeline.

   -Credential <i>PSCredential</i>
       A user account that has permission to perform this action. If Credential is not specified, the 
       current user account is used.

       Specify the value for Credential by using one of the following formats: 

       A user name: "User01" 
       A domain name and a user name: "Domain01\User01"                   
       A user principal name: "User@Domain.com"                   
       A PSCredential object, such as one returned by the Get-Credential cmdlet.

       When you type a user name, you are prompted for a password.
 
   -Name <i>String</i>
       A friendly name for the CIM session.

       You can use the name to refer to the CIM session when using other cmdlets, such as the Get-CimSession cmdlet. 
       The name is not required to be unique to the computer or the current session.
        
   -OperationTimeoutSec <i>UInt32</i>
       Duration for which the cmdlet waits for a response from the server.
    
       By default, the value of this parameter is 0, which means that the cmdlet uses the default timeout value for 
       the server.

       If the OperationTimeoutSec parameter is set to a value less than the robust connection retry timeout of 3 
       minutes, network failures that last more than the value of the OperationTimeoutSec parameter are not 
       recoverable, because the operation on the server times out before the client can reconnect.

   -Port <i>UInt32</i>
       Specifies the network port on the remote computer that is used for this connection. To connect to a remote 
       computer, the remote computer must be listening on the port that the connection uses. The default ports are 
       5985 (the WinRM port for HTTP) and 5986 (the WinRM port for HTTPS).

       Before using an alternate port, you must configure the WinRM listener on the remote computer to listen at that 
       port. Use the following commands to configure the listener: 
  
         1. winrm delete winrm/config/listener?Address=*+Transport=HTTP 

         2. winrm create winrm/config/listener?Address=*+Transport=HTTP @{Port="<i>port-number</i>"}
        
       Do not use the Port parameter unless you must. The port setting in the command applies to all computers or 
       sessions on which the command runs. An alternate port setting might prevent the command from running on all 
       computers.

   -SessionOption <i>CimSessionOptions</i>
       Sets advanced options for the new CIM session. Enter the name of a CimSessionOption object created by using 
       the New-CimSessionOption cmdlet.

   -SkipTestConnection
       By default, the New-CimSession cmdlet establishes a connection with a remote WS-Management endpoint for two 
       reasons: to verify that the remote server is listening on the port number that is specified by using the Port 
       parameter, and to verify the specified account credentials. The verification is accomplished by using a 
       standard WS-Identity operation. You can add the SkipTestConnection switch parameter if the remote 
       WS-Management endpoint cannot use WS-Identify, or if you want to reduce some data transmission time.</pre>
<p>Standard <a href="get-alias.html">Aliases</a> for New-CIMSession:<span class="code"> <b>ncms</b></span></p>
<p>New-CIMSession returns a CIM session object that can be used by all other CIM cmdlets.</p>
<p>To connect to a remote machine, pass credentials (a secure password string) obtained with <a href="get-credential.html">Get-Credential</a>.</p>
<p>The CIM session contains information about the connection, such as      ComputerName, the protocol used for the connection, session ID and instance ID. </p>
<p><b>Examples</b></p>
<p>Create a CIM session with default options,  a DCOM session to the local computer:</p>
<p class="code">PS C:\&gt; New-CimSession</p>
<p>Create a CIM session to a specific computer, store in a variable for re-use:<b><span class="code"></span></b></p>
<p class="code">PS C:\&gt; $session = New-CimSession -ComputerName computer64</p>
<p class="code">PS C:\&gt; Get-CimInstance –ClassName CIM_ComputerSystem –CimSession $session</p>
<p>Create a CIM session to multiple computers:</p>
<p><span class="code">PS C:\&gt; $all = New-CimSession -ComputerName Server64,Server65,Server66</span></p>
<p>Reboot all those machines:</p>
<p> <span class="code">PS C:\&gt; Invoke-CimMethod –ClassName Win32_OperatingSystem –MethodName <b>Reboot</b> –CimSession $all</span></p>
<p>Create a CIM session with a friendly name, to easily refer to the session in other CIM cmdlets, for      example, Get-CimSession:</p>
<p><span class="code">PS C:\&gt; New-CimSession -ComputerName Server64,Server65 -Name FileServers</span></p>
<p><span class="code">PS C:\&gt; Get-CimSession -Name File*</span><br>
<br>
Create a CIM session to a computer using a PSCredential object, create the PSCredential object with <a href="get-credential.html">Get-Credential</a>:</p>
<p class="code">PS C:\&gt; New-CimSession -ComputerName Server64 -Credential $cred -Authentication Negotiate</p>
<p>Create a CIM session using DCOM:</p>
<p class="code">PS C:\&gt; $so = New-CimSessionOption -Protocol DCOM<br>
PS C:\&gt; New-CimSession -ComputerName Server64 -SessionOption $so<br>
</p>
<p><i class="quote">“There are two ways of spreading light: to be the candle or the mirror that reflects it” ~ Edith Wharton</i></p>
<p><b>Related PowerShell Cmdlets:</b></p>
<p><span class="space"><a href="get-cimsession.html">Get-CimSession</a> -  Get current CIM session objects.<br>
<a href="get-ciminstance.html">Get-CimInstance</a> -  Get a managed resource (storage, network, software etc.)<br>
<a href="invoke-cimmethod.html">Invoke-CimMethod</a> -  Invoke a method of a CIM class or CIM instance.<br>
<a href="new-cimsessionoption.html">New-CimSessionOption</a> - Specify advanced options for  New-CimSession.<br>
<a href="remove-cimsession.html">Remove-CimSession</a> -  Remove one or more CIM session objects.</span><br>
</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- PowerShell300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6253539900"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<hr>
<div id=bl>&nbsp;</div>
<div id=br>Copyright &copy; 1999-2020 <a href="../index.html">SS64.com</a><br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/ps/new-cimsession.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:05:47 GMT -->
</html>
