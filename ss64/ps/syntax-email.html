<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/ps/syntax-email.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:13:22 GMT -->

<head><meta charset="UTF-8">
<meta name="viewport" content="width=768, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>Function to send email - PowerShell - SS64.com</title>

<style>
.tab1
{
 background-color: #ddd;
 border-collapse: collapse;
}
.tab1 td
{
 border-bottom: 1px solid #999;
  padding: 2px 8px;
}
.tab1 tbody tr:hover td
{
 background-color: #ccc;
}
</style></head><body><!-- #BeginLibraryItem "/Library/head_pssyntax.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html">SS64</a></li>
<li class="tbtn"><a href="index.html">PowerShell <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li class="tbtn"><a href="syntax.html">How-to <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>How-to: Send email with PowerShell</h1><p>A PowerShell 1.0 function for sending email, in PowerShell 2.0 and above, you can use <a href="send-mailmessage.html">send-mailmessage</a> instead.</p>
<pre>Function SS64Mail($strSubject, $strBody, $strSenderemail, $strRecipientemail, $AttachFile)
   {
      $strSMTP = "<b>ExchangeServer01</b>"  #Change this to your SMTP/Exchange server
     
      $MailMessage = New-Object System.Net.Mail.MailMessage
      $SMTPClient = New-Object System.Net.Mail.smtpClient
      $SMTPClient.host = $strSMTP
      $Recipient = New-Object System.Net.Mail.MailAddress($strRecipientemail, "Recipient")
      $Sender = New-Object System.Net.Mail.MailAddress($strSenderemail, "Sender")
     
      $MailMessage.Sender = $Sender
      $MailMessage.From = $Sender
      $MailMessage.Subject = $strSubject
      $MailMessage.To.add($Recipient)
      $MailMessage.Body = $strBody
      if ($AttachFile -ne $null) {$MailMessage.attachments.add($AttachFile) }
      $SMTPClient.Send($MailMessage)
   }
</pre>
<p>Example:</p>
<pre>
$dtmToday = ((Get-Date).dateTime).tostring()
$strSubjectLine = "Daily Report - $dtmToday"    
$strBodyText = "report attached."
$strSender = "your.name@example.com"
$strRecipient = "their.name@example.com"
$Attachment = "C:\scripts\results.doc&quot;
# Call the function to send the email
SS64Mail $strSubjectLine $strBodyText $strSender $strRecipient $Attachment</pre>
<p class="quote"><i>&ldquo;In most companies, you don't get too much mail where people are saying, 'Hey, we lost this account.' But that's what you really need to know about, because it might change what you're doing. You need to know about competitive activity. You need to know about customer feedback that says things should be better&rdquo; ~ Bill Gates </i></p>
<p><b>Related PowerShell Cmdlets:</b></p>
<p> <a href="syntax-functions.html">PowerShell Functions</a></p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- PowerShell300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6253539900"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<hr>
<div id=bl>&nbsp;</div>
<div id=br>Copyright &copy; 1999-2020 <a href="../index.html">SS64.com</a><br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/ps/syntax-email.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:13:22 GMT -->
</html>
