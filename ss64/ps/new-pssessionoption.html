<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/ps/new-pssessionoption.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:06:07 GMT -->

<head><meta charset="UTF-8">
<meta name="viewport" content="width=768, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>New-PSSessionOption - PowerShell - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html">SS64</a></li>
<li class="tbtn"><a href="index.html">PowerShell <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li class="tbtn"><a href="syntax.html">How-to <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>New-PSSessionOption</h1> 
<p>Create an object that contains advanced options for a PSSession.</p>
<pre>Syntax
      New-PSSessionOption [-ApplicationArguments <i>PSPrimitiveDictionary</i>] [-CancelTimeOut <i>int</i>]
        [-Culture <i>CultureInfo</i>] [-IdleTimeOut <i>int</i>] [-MaximumReceivedDataSizePerCommand <i>int</i>]
           [-MaximumReceivedObjectSize <i>int</i>] [-MaximumRedirection <i>int</i>] [-NoCompression]
              [-NoEncryption] [-NoMachineProfile] [-OpenTimeOut <i>int</i>] [-OperationTimeOut <i>int</i>]
                 [-ProxyAccessType <i>ProxyAccessType</i>] [-ProxyAuthentication <i>AuthenticationMechanism</i>]
                    [-ProxyCredential PSCredential] [-SkipCACheck] [-SkipCNCheck] [-SkipRevocationCheck]
                       [-UICulture <i>CultureInfo</i>] [-UseUTF16] [<i><a href="common.html">CommonParameters</a></i>]

Key
   -ApplicationArguments <i>PSPrimitiveDictionary</i>
       A hash table that is sent directly to the session configuration without interpretation.
       This hash table is available to the session configuration as a property of the PSSenderInfo class.

   -CancelTimeOut <i>int</i>
       How long PowerShell will wait for a cancel operation (CTRL + C) to complete before terminating.
       (<i>int</i> milliseconds)  The default value is 60000 (one minute).
       A value of 0 (zero) means no timeout; the command continues indefinitely.

   -Culture <i>CultureInfo</i>
       The culture to use for the PSSession.
       Enter a culture name in <i>languagecode2-country</i>/<i>regioncode2</i> format, such as &quot;ja-jP&quot;,
       or a variable/command that gets a CultureInfo object, such as &quot;get-culture&quot;.

       The default value is $null, and the culture that is set in the operating system when
       the PSSession is created is used in the PSSession.

   -IdleTimeOut <i>int</i>
       How long the PSSession will stay open if the remote computer does not receive any communication
       from the local computer, including the heartbeat signal.
       (<i>int</i> milliseconds) The default value is 240000 (4 minutes).
       The minimum value is 60000 (1 minute). When the interval expires, the PSSession closes. 

       If both the local and remote computers specify an idle timeout value, the PSSession uses
       the shorter timeout value. The local computer can set an idle timeout value by using -IdleTimeOut or
       by setting an idle timeout in the $PSSessionOption preference variable.
       The remote computer can specify an idle timeout value in the WS-Management configuration
       (WSMAN:\localhost\shell\idletimeout).

   -MaximumReceivedDataSizePerCommand <i>int</i>
       The maximum number of bytes that the local computer can receive from the remote computer
       in a single command. Enter a value in bytes. By default, there is no data size limit.
       This option is designed to protect the resources on the client computer.

   -MaximumReceivedObjectSize <i>int</i>
       The maximum size of an object that the local computer can receive from the remote computer.
       Enter a value in bytes. By default, there is no data size limit.
       This option is designed to protect the resources on the client computer.

   -MaximumRedirection <i>int</i>
       How many times PowerShell will redirect a connection to an alternate Uniform Resource Identifier(URI)
       before the connection fails. The default value is 5. A value of 0 (zero) prevents all redirection.

       This option is only used when -AllowRedirection is used in the command that creates the PSSession.

   -NoCompression
       Turn off packet compression in the PSSession.
       Compression uses more processor cycles, but it makes transmission faster.

   -NoEncryption
       Turn off data encryption.

   -NoMachineProfile
       Prevent loading the user's Windows user profile.
       As a result, the PSSession might be created faster, but user-specific registry settings,
       items such as environment variables, and certificates are not available in the PSSession.

   -OpenTimeOut <i>int</i>
       How long the client computer waits for the session connection to be established.
       (<i>int</i> milliseconds)
       When the interval expires, the command to establish the connection fails.
       The default value is 180000 (3 minutes).
       A value of 0 (zero) means no time-out; the command continues indefinitely.

   -OperationTimeOut <i>int</i>
       The maximum time that any operation in the PSSession can run.
       (<i>int</i> milliseconds)
       When the interval expires, the operation fails.
       The default value is 180000 (3 minutes).
       A value of 0 (zero) means no time-out; the operation continues indefinitely.

   -ProxyAccessType <i><a href="https://go.microsoft.com/fwlink/?LinkId=144756">ProxyAccessType</a></i>
       The mechanism is used to resolve the host name.
       Valid values are:
          IEConfig, WinHttpConfig, AutoDetect, NoProxyServer or <u>None</u>.

   -ProxyAuthentication <i><a href="https://go.microsoft.com/fwlink/?LinkID=144382">AuthenticationMechanism</a></i>
       The authentication method that is used for proxy resolution.
       Valid values are:
          Default | Basic | Credssp | Digest | Kerberos | <u>Negotiate</u> | NegotiateWithImplicitCredential

    -ProxyCredential <i>PSCredential</i>
       The credentials to use for proxy authentication.
       Enter a variable that contains a PSCredential object or a command that gets a
       PSCredential object, such as Get-Credential. If this option is not set, no credentials are specified.

   -SkipCACheck
       Specifies that when connecting over HTTPS, the client does not validate that the
       server certificate is signed by a trusted certificate authority (CA). 

       Use this option only when the remote computer is trusted by using another mechanism,
       such as when the remote computer is part of a network that is physically secure and isolated,
       or the remote computer is listed as a trusted host in a WinRM configuration.

   -SkipCNCheck
       Specifies that the certificate common name (CN) of the server does not need to match the hostname
       of the server. This option is used only in remote operations that use the HTTPS protocol. 

       Use this option only for trusted computers.

   -SkipRevocationCheck
       Do not validate the revocation status of the server certificate.

   -UICulture <i>CultureInfo</i>
       The UI culture to use for the PSSession. 

       Enter a culture name in <i>languagecode2-country</i>/<i>regioncode2</i> format, such as &quot;ja-jP&quot;,
       or a variable/command that gets a CultureInfo object, such as &quot;get-culture&quot;.

       The default value is $null, and the UI culture that is set in the operating system
       when the PSSession is created is used in the PSSession.

   -UseUTF16
       Encode the request in UTF16 format rather than UTF8 format.</pre>
<p>By default, the <a href="syntax-preference.html">$PSSessionOption variable</a> contains a PSSessionOption object with the default values for all options, as shown below.</p>
<pre>MaximumConnectionRedirectionCount : 5
NoCompression                     : False
NoMachineProfile                  : False
ProxyAccessType                   : None
ProxyAuthentication               : Negotiate
ProxyCredential                   :
SkipCACheck                       : False
SkipCNCheck                       : False
SkipRevocationCheck               : False
OperationTimeout                  : 00:03:00
NoEncryption                      : False
UseUTF16                          : False
IncludePortInSPN                  : False
OutputBufferingMode               : None
Culture                           :
UICulture                         :
MaximumReceivedDataSizePerCommand :
MaximumReceivedObjectSize         : 209715200
ApplicationArguments              :
OpenTimeout                       : 00:03:00
CancelTimeout                     : 00:01:00
IdleTimeout                       : -00:00:00.0010000</pre>
<p><b>Examples</b></p>
<p>Create a session option object with all of the default values: </p>
<pre>PS C:&gt; New-PSSessionOption</pre>
<p>Create a session option object and edit some of its values: </p>
<pre>PS C:&gt; $a = new-pssessionoption
PS C:&gt; $a.UICulture = (get-UICulture)
PS C:&gt; $a.OpenTimeout = (new-timespan -minutes 4)
PS C:&gt; $a.MaximumConnectionRedirectionCount = 1</pre>
<p>Use a session option object to configure a session:</p>
<pre>PS C:&gt; $pso = new-pssessionoption -Culture &quot;fr-fr&quot; -MaximumReceivedObjectSize 10MB
PS C:&gt; new-pssession -computerName Server01 -SessionOption $pso</pre>
<p>Start an interactive session with the Server64 computer, the New-PSSessionOption command is enclosed in parentheses to ensure it runs before Enter-PSSession:</p>
<pre>PS C:&gt; enter-pssession -computername Server64 -sessionOption (new-pssessionoption -noEncryption -noCompression)</pre>
<p>Create  a $PSSessionOption preference variable to establish default values for session options (to make this available in all sessions, add it to your <a href="syntax-profile.html">PowerShell profile</a>): </p>
<pre>PS C:&gt; $PSSessionOption = New-PSSessionOption -OpenTimeOut 120000</pre>
<p class="quote"><i>“Coping with the demands of everyday life would be exceedingly trying if one could arrive at solutions to problems only by actually performing possible options and suffering the consequences” ~ Albert Bandura</i></p>
<p><b>Related PowerShell Cmdlets:</b></p>
<p><span class="space"><a href="enable-pssessionconfiguration.html">Enable-PSSessionConfiguration</a> - Enable PS session configuration.<br>
<a href="register-pssessionconfiguration.html">Register-PSSessionConfiguration</a> - Create and register a new PS session configuration.</span></p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- PowerShell300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6253539900"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<hr>
<div id=bl>&nbsp;</div>
<div id=br>Copyright &copy; 1999-2020 <a href="../index.html">SS64.com</a><br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/ps/new-pssessionoption.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:06:07 GMT -->
</html>
