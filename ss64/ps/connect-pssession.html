<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/ps/connect-pssession.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:06:07 GMT -->

<head><meta charset="UTF-8">
<meta name="viewport" content="width=768, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>Connect-PSSession - PowerShell - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html">SS64</a></li>
<li class="tbtn"><a href="index.html">PowerShell <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li class="tbtn"><a href="syntax.html">How-to <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>Connect-PSSession</h1> 
<p>The Connect-PSSession cmdlet reconnects to user-managed  PowerShell sessions ( PSSessions ) that were      disconnected. It works on sessions that are disconnected intentionally, such as by using  <a href="disconnect-pssession.html">Disconnect-PSSession</a> or the InDisconnectedSession parameter of  <a href="invoke-command.html">Invoke-Command</a> , and those that were disconnected      unintentionally, such as by a temporary network outage.</p>
<pre>Syntax
      Connect-PSSession [<b>-ConnectionUri</b>] <i>Uri</i>[] [-AllowRedirection]
         [-Authentication {Default | Basic | Negotiate | NegotiateWithImplicitCredential | Credssp | Digest | Kerberos}]
            [-CertificateThumbprint <i>String</i>] [-ConfigurationName <i>String</i>] [-Credential <i>PSCredential</i>] [-Name <i>String</i>[]]
               [-SessionOption <i>PSSessionOption</i>] [-ThrottleLimit <i>Int32</i>] [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]
    
      Connect-PSSession <b>-InstanceId</b> <i>Guid</i>[] [-ConnectionUri] <i>Uri</i>[] [-AllowRedirection]
         [-Authentication {Default | Basic | Negotiate | NegotiateWithImplicitCredential | Credssp | Digest | Kerberos}]
            [-CertificateThumbprint <i>String</i>] [-ConfigurationName <i>String</i>] [-Credential <i>PSCredential</i>]
               [-SessionOption <i>PSSessionOption</i>] [-ThrottleLimit <i>Int32</i>] [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]
    
      Connect-PSSession [<b>-ComputerName</b>] <i>String</i>[] [-ApplicationName <i>String</i>]
         [-Authentication {Default | Basic | Negotiate | NegotiateWithImplicitCredential | Credssp | Digest | Kerberos}]
            [-CertificateThumbprint <i>String</i>] [-ConfigurationName <i>String</i>] [-Credential <i>PSCredential</i>] [-Name <i>String</i>[]] [-Port <i>Int32</i>] 
               [-SessionOption <i>PSSessionOption</i>] [-ThrottleLimit <i>Int32</i>] [-UseSSL] [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]
    
      Connect-PSSession <b>-InstanceId</b> <i>Guid</i>[] [-ComputerName] <i>String</i>[] [-ApplicationName <i>String</i>]
         [-Authentication {Default | Basic | Negotiate | NegotiateWithImplicitCredential | Credssp | Digest | Kerberos}]
            [-CertificateThumbprint <i>String</i>] [-ConfigurationName <i>String</i>] [-Credential <i>PSCredential</i>][-Port <i>Int32</i>] 
               [-SessionOption <i>PSSessionOption</i>] [-ThrottleLimit <i>Int32</i>] [-UseSSL] [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]
    
      Connect-PSSession [<b>-Id</b>] <i>Int32</i>[] [-ThrottleLimit <i>Int32</i>] [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]
    
      Connect-PSSession <b>-InstanceId</b> <i>Guid</i>[] [-ThrottleLimit <i>Int32</i>] [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]
    
      Connect-PSSession <b>-Name</b> <i>String</i>[] [-ThrottleLimit <i>Int32</i> [-Confirm]] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]
    
      Connect-PSSession [-Session] <i><b>PSSession</b></i>[] [-ThrottleLimit <i>Int32</i>] [-Confirm] [-WhatIf] [<i><a href="common.html">CommonParameters</a></i>]

Key
   -AllowRedirection
       Allow redirection of this connection to an alternate Uniform Resource Identifier (URI).

       When you use -ConnectionURI, the remote destination can return an instruction to redirect to
       a different URI. By default, PowerShell does not redirect connections.

       You can also limit the number of times the connection is redirected by changing the
       MaximumConnectionRedirectionCount session option value. Use the MaximumRedirection parameter of the
       New-PSSessionOption cmdlet or set the MaximumConnectionRedirectionCount property of the $PSSessionOption
       preference variable. The default value is 5.

    -ApplicationName <i>string</i>
       The name of an application. This cmdlet connects only to sessions that use the specified application.
        
       Enter the application name segment of the connection URI. For example, in the following connection URI, the 
       application name is WSMan: `http://localhost:5985/WSMAN`. The application name of a session is stored in the 
       Runspace.ConnectionInfo.AppName property of the session.
        
       The value of this parameter is used to select and filter sessions. It does not change the application that the 
       session uses.

   -Authentication <i>Authentication</i>
       The authentication mechanism to be used at the server. Possible values are:
        
        Basic      Send username and password in clear text.
        Default    Use the authentication method implemented by WS-Management protocol. This is the default.
        Digest     Challenge-response scheme using a server-specified data string for the challenge.
        Kerberos   Authenticate by using Kerberos certificates.
        Negotiate  Challenge-response that negotiates an authentication scheme.
                    e.g. Kerberos protocol or NTLM.
        NegotiateWithImplicitCredential   Use the credentials cached on the PSSession computer.
        CredSSP    Use Credential Security Service Provider (CredSSP) authentication, delegate
                   credentials to a remote computer. This increases the security risk, if the remote 
                   computer is compromised, the credentials could be used to control the network session.
                   (Windows Vista or later versions.)

   -CertificateThumbprint <i>string</i>
       The certificate thumbprint of the digital public key certificate (X509) of a user account
       that has permission to perform this action.

       Certificates are used in client certificate-based authentication.
       They can be mapped only to local user accounts; they do not work with domain accounts.

       To get a certificate thumbprint, use the Get-Item or Get-ChildItem command
       in the PowerShell Cert: drive.

   -ComputerName <i>string</i>
       Specifies the computers on which the disconnected sessions are stored. Sessions are stored on the computer 
       that is at the server-side or receiving end of a connection. The default is the local computer.
        
       Type the NetBIOS name, an IP address, or a fully qualified domain name of one computer. Wildcard characters 
       are not permitted. To specify the local computer, type the computer name, localhost, or a dot (.)

   -ConfigurationName <i>string</i>
       Connect only to sessions that use the specified session configuration.
        
       Enter a configuration name or the fully qualified resource URI for a session configuration. If you specify 
       only the configuration name, the following schema URI is prepended: http://schemas.microsoft.com/powershell. 
       The configuration name of a session is stored in the ConfigurationName property of the session.
        
       The value of this parameter is used to select and filter sessions. It does not change the session 
       configuration that the session uses.
        
       For more information about session configurations, see about_Session_Configurations.

    -Confirm
       Prompt for confirmation before running the cmdlet.

    -ConnectionURI <i>Uri</i>
       Specifies a Uniform Resource Identifier (URI) that defines the connection endpoint for the
       interactive session. The URI must be fully qualified. 

       The format of this string is as follows: 
           <i>Transport</i>://<i>ComputerName</i>:<i>Port</i>/<i>ApplicationName</i>
       The default value is as follows:
           http://localhost:5985/WSMAN

       Valid values for the Transport segment of the URI are HTTP and HTTPS.
       If you do not specify a ConnectionURI, you can use the UseSSL, ComputerName, Port, and
       ApplicationName parameters to specify the URI values.

       If you specify a connection URI with a Transport segment, but do not specify a port,
       the session is created with standards ports: 80 for HTTP and 443 for HTTPS.
       To use the default ports for PowerShell remoting, specify port 5985 for HTTP or 5986 for HTTPS.

       If the destination computer redirects the connection to a different URI, PowerShell will prevent
       the redirection unless you use -AllowRedirection in the command.

   -Credential <i>PSCredential</i>
       A user account that has permission to connect to the disconnected session. default=current user.
       e.g. "User64", "Domain01\User64", or "User@Domain.com". Or a PSCredential object, such as 
       returned by <a href="get-credential.html">Get-Credential</a>. When you type a user name, you will be prompted for a password.

   -Id <i>int</i>
       The IDs of the disconnected sessions. (from Get-PSSession)
       The Id parameter works only when the disconnected session was previously connected to the current session.

       This parameter is valid, but not effective, when the session is stored on the local computer,
       but was not connected to the current session.

   -InstanceId <i>Guid</i>
       The instance IDs of the disconnected sessions.
        
       The instance ID is a GUID that uniquely identifies a PSSession on a local or remote computer.
        
       The instance ID is stored in the InstanceID property of the PSSession.

   -Name <i>string</i>
       Specifies the friendly names of the disconnected sessions.

    -Port <i>int</i>
       The network port on the remote computer that is used to reconnect to the session.
       The default ports are 5985, which is the WinRM port for HTTP, and 5986, which is the WinRM port for HTTPS.
       Before using an alternate port, configure the WinRM listener on the remote computer to listen at that
       port. Use the following commands to configure the listener:
        1. `Remove-Item -Path WSMan:\Localhost\listener\listener* -Recurse`
        2. `New-Item -Path WSMan:\Localhost\listener -Transport http -Address * -Port <i>port-number</i>`

       Do not use the Port parameter unless you must. The port setting in the command applies to
       all computers or sessions on which the command runs.
       An alternate port setting might prevent the command from running on all computers.

   -Session <i>PSSession</i>
       Specifies the disconnected sessions. Enter a variable that contains the PSSession objects or a command that 
       creates or gets the PSSession objects, such as a Get-PSSession command.

   -SessionOption <i>PSSessionOption</i>
       Set advanced options for the session. Enter a SessionOption object that you createusing New-PSSessionOption,
       or a hash table in which the keys are session option names and the values aresession option values.

       The default values for the options are determined by the value of the $PSSessionOption
       preference variable, if it is set. Otherwise, the session uses the system defaults.
       For information about the $PSSessionOption preference variable, see about_Preference_Variables.

   -UseSSL
       Use the Secure Sockets Layer (SSL) protocol to establish a connection to the remote computer.
       By default, SSL is not used.
       WS-Management encrypts all Windows PowerShell content transmitted over the network.
       UseSSL is an additional protection that sends the data across an HTTPS connection instead of
       an HTTP connection.
       If you use this parameter, but SSL is not available on the port used for the command, the command fails.

   -ThrottleLimit <i>Int32</i>
       Specifies the maximum number of concurrent connections that can be established to run this command. If you 
       omit this parameter or enter a value of 0, the default value, 32, is used.
        
       The throttle limit applies only to the current command, not to the session or to the computer.
        
   -UseSSL
       Indicates that this cmdlet uses the Secure Sockets Layer (SSL) protocol to connect to the disconnected 
       session. By default, SSL is not used.
        
       WS-Management encrypts all Windows PowerShell content transmitted over the network. The UseSSL parameter is an 
       additional protection that sends the data across an HTTPS connection instead of an HTTP connection.
        
       If you use this parameter, but SSL is not available on the port that is used for the command, the command 
       fails.
        
    -WhatIf
       Show what would happen if the cmdlet runs. The cmdlet is not run.</pre>
<p>Standard <a href="get-alias.html">Aliases</a> for Connect-PSSession:<span class="code"> cnsn</span></p>
<p>Connect-PSSession can connect to any disconnected session      that was started by the same user. These include those that were started by or disconnected from other sessions on      other computers.          However, Connect-PSSession cannot connect to broken or closed sessions, or interactive sessions started by using      the Enter-PSSession cmdlet. Also you cannot connect sessions to sessions started by other users, unless you can      provide the credentials of the user who created the session.          </p>
<p>For more information about the Disconnected Sessions feature, see about_Remote_Disconnected_Sessions.          </p>
<p>This cmdlet was introduced in Windows PowerShell 3.0.</p>
<p><b>Examples</b></p>
<p>Reconnect to a session: </p>
<pre>PS C:&gt; Connect-PSSession -ComputerName Server01 -Name ITTask</pre>
<p>List, disconnect and then reconnect to a session:</p>
<pre>PS C:&gt; Get-PSSession
PS C:&gt; Get-PSSession | Disconnect-PSSession
PS C:&gt; Get-PSSession | Connect-PSSession</pre>
<p>Create sessions on a remote computer and run a script in each,<br>
start a background job in the session in the $s variable,<br>
disconnect from the session in the $s variable<br>
then  from a different workstation - get the sessions on the Server64 computer,<br>
and lastly connect to the      ITTask session - saving the session 
in the $s variable:</p>
<pre>PS C:&gt; $s = New-PSSession -ComputerName Server64 -Name ITTask -ConfigurationName ITTasks
PS C:&gt; Invoke-Command -Session $s {Start-Job -FilePath \\Server30\Scripts\Backup-SQLDatabase.ps1}
PS C:&gt; Disconnect-PSSession -Session $s -OutputBufferingMode Drop -IdleTimeoutSec 60*60*15

PS C:&gt; Get-PSSession -ComputerName Server64 -Name ITTask
PS C:&gt; $s = Connect-PSSession -ComputerName Server64 -Name ITTask</pre>
<p class="quote"><i>“The eyes are one of the most powerful tools a woman can have. With one look, she can relay the most intimate message. After the connection is made, words cease to exist” -  Jennifer Salaiz </i></p>
<p><b>Related PowerShell Cmdlets:</b></p>
<p class="space"><a href="exit-pssession.html">Exit-PSSession</a> - End an interactive session with a remote computer.<br>
<a href="disconnect-pssession.html">Disconnect-PSSession</a> -     Disconnect from a session.<br>
<a href="new-pssession.html">New-PSSession</a> -     Create a persistent connection to a local or remote computer.<br>
<a href="invoke-command.html">Invoke-Command</a> -   Run a single command on local or remote computer.</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- PowerShell300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6253539900"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<hr>
<div id=bl>&nbsp;</div>
<div id=br>Copyright &copy; 1999-2020 <a href="../index.html">SS64.com</a><br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/ps/connect-pssession.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:06:07 GMT -->
</html>
